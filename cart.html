---
title: "Cart" 
hero: Cart
---
<div class="cart-display">
	<div id="cartItems"></div>
	<div id="subtotal" style="font-weight: bold;"></div>
  <div id="checkout-div">
    <div class="button" onclick="checkout();">{% include snipcart-button.html text="Checkout" %}</div>
    or <a href="/">add more items</a>
  <div>
</div>

<script>
  var invoice = {subtotal: 0, purchasing: []};
	function updateCartDisplay() {
      invoice.subtotal = 0;
      invoice.purchasing = [];

			const cartItemsDiv = document.getElementById('cartItems');
			const subtotalDiv = document.getElementById('subtotal');

      cartItemsDiv.innerHTML = "";
      if(Object.keys(cart).length === 0){
        cartItemsDiv.innerHTML = `<h3>No items in your cart! <a href="/">Shop now</a></h3>`;
        document.getElementById('checkout-div').style.display = 'none';
      }else{
        document.getElementById('checkout-div').style.display = 'block';
				/*cartItemsDiv.innerHTML += `
				<div class="cart-entry">
						Item,Quantity,price,total
				</div>`*/
      }
			let subtotal = 0;

      // Convert cart to an object consistent with display and invoice
			for (const sku in cart) {
          const { name, size, quantity, price } = cart[sku];
					const skuTotalPrice = parseFloat((quantity * price).toFixed(2));
          invoice.purchasing.push({sku,name,size,quantity,price,skuTotalPrice});
					invoice.subtotal += skuTotalPrice;
			}
      invoice.subtotal = parseFloat(invoice.subtotal.toFixed(2));
      for(const skuPurchasing of invoice.purchasing){
          const {sku, name, size, quantity, price, skuTotalPrice} = skuPurchasing;
					cartItemsDiv.innerHTML += `
							<div class="cart-entry">
									${name}(${size}): 
									<input type="number" min="1" value="${quantity}" onchange="updateQuantity('${sku}', this.value)">
									x $${price} = $${skuTotalPrice}
									<span class="remove-button" onclick="removeFromCart('${sku}')"><b>X</b></span>
							</div>
					`;
      }
			subtotalDiv.innerHTML = `Subtotal: $${invoice.subtotal}`;
	}

	function updateQuantity(sku, quantity) {
			if (quantity < 1) quantity = 1; // Ensure quantity is at least 1
			cart[sku].quantity = Number(quantity);
			saveCart();
      updateCartDisplay();
	}

	function removeFromCart(product) {
			delete cart[product];
			saveCart();
      updateCartDisplay();
	}
  function checkout(){
    console.log(invoice);
  }
  updateCartDisplay();
</script>

<style>
		div .cart-display {
			margin: 20px auto;
			max-width: 90%; 
			border: 1px solid #ddd;
			padding: 10px;
      text-align: center;
		}
    div .cart-entry {
     display: flex;
     align-items: center;
     justify-content: center;
     margin: 10px 0;
    }
		input[type="number"] {
			width: 75px;
			text-align: center;
		}
		.remove-button {
			margin-left: 10px;
			cursor: pointer;
			color: red;
		}
</style>
